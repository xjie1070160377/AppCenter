<!DOCTYPE html>
<html>

<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>${SYS_SNAME} - 管理中心</title>
	<link href="${ctxPath}/static/base/fonts/iconfont/iconfont.css" rel="stylesheet">
    <link href="${ctxPath}/static/base/css/bootstrap.min.css" rel="stylesheet">
    <link href="${ctxPath}/static/base/font-awesome/css/font-awesome.css" rel="stylesheet">
    <link href="${ctxPath}/static/base/css/plugins/iCheck/custom.css" rel="stylesheet">
    <link href="${ctxPath}/static/base/css/animate.css" rel="stylesheet">
    <link href="${ctxPath}/static/base/css/plugins/jQueryUI/jquery-ui-1.10.4.custom.min.css" rel="stylesheet">
    <link href="${ctxPath}/static/base/css/plugins/jqGrid/ui.jqgrid.css" rel="stylesheet">
    <link href="${ctxPath}/static/base/css/style.css" rel="stylesheet">
    <link href="${ctxPath}/static/base/css/form.css" rel="stylesheet">
    <link href="${ctxPath}/static/base/css/tab.css" rel="stylesheet">

    <link href="${ctxPath}/static/base/css/plugins/awesome-bootstrap-checkbox/awesome-bootstrap-checkbox.css" rel="stylesheet">

	<link href="${ctxPath}/static/base/css/plugins/switchery/switchery.css" rel="stylesheet">

    <link href="${ctxPath}/static/base/css/plugins/sweetalert/sweetalert.css" rel="stylesheet">

    <!-- Data Tables -->
    <link href="${ctxPath}/static/base/css/plugins/dataTables/dataTables.bootstrap.css" rel="stylesheet">
    <link href="${ctxPath}/static/base/css/plugins/dataTables/dataTables.responsive.css" rel="stylesheet">
    <link href="${ctxPath}/static/base/css/plugins/dataTables/dataTables.tableTools.min.css" rel="stylesheet">
    
    <script src="${ctxPath}/static/base/js/jquery-2.1.1.js"></script>
    <script src="${ctxPath}/static/base/js/plugins/timer/timer.jquery.min.js"></script>
    <script src="${ctxPath}/static/base/js/bootstrap.min.js"></script>
    <script src="${ctxPath}/static/base/js/plugins/metisMenu/jquery.metisMenu.js"></script>
    <script src="${ctxPath}/static/base/js/plugins/slimscroll/jquery.slimscroll.min.js"></script>
    
    <script src="${ctxPath}/static/base/js/plugins/jquery-ui/jquery-ui.min.js"></script>

    <script src="${ctxPath}/static/base/js/plugins/sweetalert/sweetalert.min.js"></script>

    <script src="${ctxPath}/static/base/js/plugins/jeditable/jquery.jeditable.js"></script>
    
    <script src="${ctxPath}/static/base/js/plugins/dataTables/jquery.dataTables.js"></script>
    <script src="${ctxPath}/static/base/js/plugins/dataTables/dataTables.bootstrap.js"></script>
    <script src="${ctxPath}/static/base/js/plugins/dataTables/dataTables.responsive.js"></script>
    <script src="${ctxPath}/static/base/js/plugins/dataTables/dataTables.tableTools.min.js"></script>
    
    <!-- Peity -->
    <script src="${ctxPath}/static/base/js/plugins/peity/jquery.peity.min.js"></script>

    <!-- jqGrid -->
    <script src="${ctxPath}/static/base/js/plugins/jqGrid/i18n/grid.locale-cn.js"></script>
    <script src="${ctxPath}/static/base/js/plugins/jqGrid/jquery.jqGrid.min.js"></script>
    
    <!-- Jquery Validate -->    
    <script src="${ctxPath}/static/base/js/plugins/validate/jquery.validate.min.js"></script>
    <script src="${ctxPath}/static/base/js/plugins/validate/localization/messages_zh.js"></script>
    
    <!-- iCheck -->
    <script src="${ctxPath}/static/base/js/plugins/iCheck/icheck.min.js"></script>

	<script src="${ctxPath}/static/base/js/plugins/switchery/switchery.js"></script>
    
    <script src="${ctxPath}/static/base/js/plugins/layer/layer.js"></script>
    <script src="${ctxPath}/static/base/js/plugins/fullcalendar/moment.min.js"></script>

    <script src="${ctxPath}/static/base/js/inspinia.js"></script>
    <script src="${ctxPath}/static/base/js/plugins/pace/pace.min.js"></script>
    
    <!-- DROPZONE -->
    <link href="${ctxPath}/static/base/css/plugins/dropzone/basic.css" rel="stylesheet">
    <link href="${ctxPath}/static/base/css/plugins/dropzone/dropzone.css" rel="stylesheet">
    <script src="${ctxPath}/static/base/js/plugins/dropzone/dropzone.js"></script>
<!--     datapicker -->
    <link href="${ctxPath}/static/base/css/plugins/datapicker/datepicker3.css" rel="stylesheet">
   <script src="${ctxPath}/static/base/js/plugins/datapicker/bootstrap-datepicker.js"></script>
   <script type="text/javascript" src="${ctxPath}/static/base/js/plugins/datapicker/locales/bootstrap-datepicker.zh-CN.js" charset="UTF-8"></script>
   
   <link href="${ctxPath}/static/base/css/plugins/datetimepicker/bootstrap-datetimepicker.min.css" rel="stylesheet">
   <script src="${ctxPath}/static/base/js/plugins/datetimepicker/bootstrap-datetimepicker.js"></script>
   <script type="text/javascript" src="${ctxPath}/static/base/js/plugins/datetimepicker/locales/bootstrap-datetimepicker.zh-CN.js" charset="UTF-8"></script>
   
   <script type="text/javascript">
	//window.UEDITOR_HOME_URL = "${ctxPath}/static/base/js/plugins/ueditor/";
	</script>
    
<!--     duallistbox -->
    <link href="${ctxPath}/static/base/css/plugins/duallistbox/bootstrap-duallistbox.min.css" rel="stylesheet">
   <script src="${ctxPath}/static/base/js/plugins/duallistbox/jquery.bootstrap-duallistbox.min.js"></script>
    
   
    <!-- <script src="${ctxPath}/static/base/js/plugins/moocLinkage/jqeury.moocLinkage.js"></script>
	<script src="${ctxPath}/static/base/js/plugins/moocDataGrid/jquery.moocDatagrid.js"></script> -->
    
    
    <script src="${ctxPath}/static/base/js/plugins/echarts/echarts.common.min.js"></script>
    <link href="${ctxPath}/static/base/css/plugins/jsTree/style.min.css" rel="stylesheet">
	<script src="${ctxPath}/static/base/js/plugins/jsTree/jstree.min.js"></script>
	<script src="${ctxPath}/static/base/js/plugins/ladda/spin.min.js"></script>
	
	<script type="text/javascript">
	var ctxPath = "${ctxPath}";
	var SYS_ADMIN_PATH="${SysAdminPath()}";
	</script>
    
    <style type="text/css">
    	#columnFiled {padding: 0 12px;}
    	.form-control {padding: 0 12px;}
    </style>
</head>

<body>

    <div id="wrapper">

		<%include("/share/mnav.html"){} %>

        <div id="page-wrapper" class="gray-bg">
        <div class="row border-bottom">
        <nav class="navbar navbar-static-top" role="navigation" style="margin-bottom: 0">
        <div class="navbar-header">
            <a class="navbar-minimalize minimalize-styl-2 btn btn-primary " href="#"><i class="fa fa-bars"></i> </a>

        </div>
            <ul class="nav navbar-top-links navbar-right">
                <li>
                    <i class="fa fa-bell"></i> <span id="chickenSoup" class="m-r-sm text-muted welcome-message"></span>
                </li>
                
<!--                 
                <li class="dropdown">
                    <a class="dropdown-toggle count-info" data-toggle="dropdown" href="#">
                        <i class="fa fa-envelope"></i>  <span class="label label-warning">2</span>
                    </a>
                    <ul class="dropdown-menu dropdown-messages">
                        <li>
                            <div class="dropdown-messages-box">
                                <a href="profile.html" class="pull-left">
                                    <img alt="image" class="img-circle" src="${ctxPath}/static/base/images/msgHead.jpg">
                                </a>
                                <div class="media-body">
                                    <small class="pull-right">30分钟前</small>
                                    <strong>阳仔</strong> 关注了风流倜傥的 <strong>远哥</strong>. <br>
                                    <small class="text-muted">2016-05-01 13:00:00</small>
                                </div>
                            </div>
                        </li>
                        <li class="divider"></li>
                        
                        <li>
                            <div class="dropdown-messages-box">
                                <a href="profile.html" class="pull-left">
                                    <img alt="image" class="img-circle" src="${ctxPath}/static/base/images/msgHead.jpg">
                                </a>
                                <div class="media-body">
                                    <small class="pull-right">1小时前</small>
                                    <strong>花花</strong> 关注了风流倜傥的 <strong>远哥</strong>. <br>
                                    <small class="text-muted">2016-05-01 13:00:00</small>
                                </div>
                            </div>
                        </li>
                        <li class="divider"></li>
                        
                        
                        <li>
                            <div class="text-center link-block">
                                <a href="#">
                                    <i class="fa fa-envelope"></i> <strong>查看所有消息</strong>
                                </a>
                            </div>
                        </li>
                    </ul>
                </li>
                
                <li class="dropdown">
                    <a class="dropdown-toggle count-info" data-toggle="dropdown" href="#">
                        <i class="fa fa-bell"></i>  <span class="label label-primary">1</span>
                    </a>
                    <ul class="dropdown-menu dropdown-alerts">
                        <li>
                            <a href="#">
                                <div>
                                    <i class="fa fa-envelope fa-fw"></i> 插件已加载完成
                                    <span class="pull-right text-muted small">1分钟前</span>
                                </div>
                            </a>
                        </li>
                        <li class="divider"></li>
                        
                        <li>
                            <div class="text-center link-block">
                                <a href="#">
                                    <strong>查看所有提醒</strong>
                                    <i class="fa fa-angle-right"></i>
                                </a>
                            </div>
                        </li>
                    </ul>
                </li>
				 -->

                <li>
                    <a href="${ctxPath}/${SYS_ADMIN_PATH}/logout">
                        <i class="fa fa-sign-out"></i> 退出
                    </a>
                </li>
            </ul>

        </nav>
        </div>
		
		${layoutContent}		

        <div class="footer">
            <div>
                ${SYS_NAME} &copy; ${date() , dateFormat="yyyy"}
                
            </div>
            <div id="serverTime" style="display: none;"></div>
        </div>

        </div>
        </div>
        
        <div id="popWin"></div>
        

		<script type="text/javascript">
		$(document).ready(function() {
			
			$(document).ajaxError(function(event, request, settings){
				//alert("An error occurred!"+request.status);
				if(request.status==401){
					//无权限
					//layer.alert("无访问权限.", {icon: 2});
				}
				
			});
			
			layer.config({
				shift: 1, //默认动画风格
				skin: 'layui-layer-molv' //默认皮肤
			});
						
			$("#navMenu a").click(function(){
				if($(this).parent().parent().hasClass("nav-second-level")){
					$(".nav-second-level li").removeClass("active");
					$(this).parent().addClass("active");
				}
				var contentUrl = $(this).attr("data-url");
				loadFrameContent(contentUrl);
			});
			
			
			loadFrameContent("/index");
			
			$(window).bind("load resize", function(){
				var bodyWidth = document.body.clientWidth;
				if(bodyWidth > 768 && bodyWidth < 1300 ){
					if($("body").hasClass("mini-navbar")){
						return;
					}else{
						$("body").addClass("mini-navbar");
					}
				}else{
					if($("body").hasClass("mini-navbar")){
						$("body").removeClass("mini-navbar");
					}
				}
			});
				
			startLoop();
			layer.config({
			    extend: 'extend/layer.ext.js'
			});
		});
		
		function loadFrameContent(contentUrl, data, callBack){
			if(contentUrl==null || contentUrl=="${ctxPath}/${SYS_ADMIN_PATH}/#" || contentUrl=="#"){
				return;
			}
			
			var openUrl = "";

			if(contentUrl.indexOf("/")==0) {
				openUrl = "${ctxPath}/${SYS_ADMIN_PATH}" + contentUrl;
			}else{
				openUrl = "${ctxPath}/${SYS_ADMIN_PATH}/" + contentUrl;
			}
			
			//load(url,data,function(response,status,xhr))
			$("#frameContent").load(openUrl, data, callBack);
		}
		
		function dateTimeFmt(value, row, index ){
			if(value){
				return moment(value).format("YYYY-MM-DD HH:mm:ss");
			}else{
				return ""
			}
		}
		
		function dateFmt(value, row, index ){
			if(value){
				return moment(value).format("YYYY-MM-DD");
			}else{
				return ""
			}
		}
		
		function closeAllPopWin(){
			layer.closeAll();
		}
		
		function startLoop(){
			//duration 秒不能超过60
			//例如：70秒为 1m10s，30秒为 30s，5分钟为 5m
			$('#serverTime').timer({
			    duration: '5m',
			    callback: function() {
			    	getServerTime();
			    },
			    repeat: true
			});
			
		}
		
		function getServerTime(){
			
			$.post("sys/serverTime", {
				rnd : Math.random()
			}, function(json) {
				
			}, 'json');
			
		}
		
		//心灵鸡汤
		(function chickenSoup(){
			$.post("sys/chickensoup/chickensoupListJson", function(result){
				if(result.resultStatus){
					chickensoups =  result.rows;
					var chickenSoup = $("#chickenSoup");
					if(chickensoups.length == 0){
						chickensoups = ["马云说：什么都想自己干，这个世界上你干不完。","前方是绝路，希望在转角！","永远要相信边上的人比你聪明！","有时候死扛下去总是有机会的！","什么是团队？团队就是不要让团队中任何一个人失败！"];
					}
					var random = Math.floor(Math.random()* chickensoups.length);
					chickenSoup.text(chickensoups[random]);
					var i = 0;
					setInterval(function(){
						if(i > chickensoups.length){
							i = 0;
						}
						chickenSoup.fadeOut(1000, function(){
							chickenSoup.text(chickensoups[i]).fadeIn(1000);
						})
						
						i++;
					}, 60 * 1000 )
				}
			}, "json")
		})();
		
		</script>

</body>

</html>
